<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
	<head>
		<title>Media API Exercise</title>
				<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<style type="text/css">
			body {font-family : Helvetica,Arial,sans-serif; color : #619FA8;}
			legend {
				color: #CF0050;
			}
		</style>
		<!-- the script below is just included for debugging -->
		<script type="text/javascript" src="http://files.brightcove.com/prettyprint.js"></script>
				<!-- script for debugging -->
		<script type="text/javascript">
		/*
	    This log function for debugging depends on James Padolsey's prettyprint.js, which you can download from http://james.padolsey.com/javascript/prettyprint-for-javascript/, or reference from http://files.brightcove.com/prettyprint.js -- the version there is very slightly modified
	    */
  		function log(message) {
    		var logEntry = prettyPrint(message);
    		document.getElementById("results").appendChild(logEntry);
  		}
		</script>

	</head>
	<body onload="BCL.injectScript();">
		<h2>Media API Training</h2>
    <fieldset>
      <legend>API Query</legend> <p id="query" style="width:100%;border:none"></p>
    </fieldset><br>
    <fieldset>
      <legend>Results</legend>
			<div id="results"></div>
    </fieldset><br>
		<!-- This is the script to modify for the exercise -->
		<script type="text/javascript">
			// BCL Media API search maker -- adapted from JS-MAPI on opensource.brightcove.com
			// namespace to keep all the "global" vars together
			var BCL = {};
			BCL.token = "w8DSqB3RP9cd1-PDaowHd9CNwCXVC4XiDTuDeoxvmGqkGPt4dP3IHQ..";
			BCL.callback = "BCL.onSearchResponse";
			BCL.url = "http://api.brightcove.com/services/library";
			BCL.command = "search_videos";
			BCL.params = {};
			BCL.srcValue = "";
			BCL.params.video_fields = "id,name,shortDescription,customFields,renditions,thumbnailURL,videoStillURL,length,FLVURL,videoFullLength";
			BCL.params
			// log(BCL.params);
			/**
			 * Injects API calls into the head of a document
			 */
			BCL.injectScript = function () {
				var scriptElement = document.createElement("script");
				BCL.srcValue = BCL.url + "?command=" + BCL.command + "&token=" + BCL.token + "&callback=" + BCL.callback;
				for (var param in BCL.params) {
					BCL.srcValue += "&" + param + "=" + BCL.params[param];
				}
				log(BCL.srcValue);
				scriptElement.setAttribute("src", BCL.srcValue);
				scriptElement.setAttribute("type", "text/javascript");
				document.getElementsByTagName("head")[0].appendChild(scriptElement);
			};
			BCL.onSearchResponse = function(jsonData) {
				document.getElementById("query").innerHTML = BCL.srcValue;
				//log(jsonData);
				var str = "";
				for (var i = 0; i < jsonData["items"].length; i++) {
					var video = jsonData["items"][i];
					str += video.name + "<br/>"
				}
				document.getElementById("results").innerHTML = str;
			}

		</script>

	</body>
</html>
