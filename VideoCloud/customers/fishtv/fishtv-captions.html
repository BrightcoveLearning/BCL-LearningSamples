
<html>
    <head>      
      <!-- script src="http://admin.brightcove.com/js/APIModules.js"> </script -->
      <!-- script src="_misc/inc/js/brightcove/BrightcoveExperiences.js" type="text/javascript"> </script -->     
    </head>
    <body>
                <!-- Start of Brightcove Player -->

                    <script language="JavaScript" type="text/javascript" src="http://admin.brightcove.com/js/BrightcoveExperiences.js"></script>      

                    <object id="myExperience" class="BrightcoveExperience">
                      <param name="wmode" value="transparent" />
                      <param name="bgcolor" value="#FFFFFF" />
                      <param name="width" value="480" />
                      <param name="height" value="270" />
                      <param name="playerID" value="1654948543001" />
                      <param name="playerKey" value="AQ~~,AAABXVHA1BE~,Shr7CKdq2n45_fyY9UFN2bZtvW5wJTRU" />
                      <param name="isVid" value="true" />                      
                      <param name="dynamicStreaming" value="true" />                      
                      <param name="isUI" value="true" />
                      <param name="includeAPI" value="true" />
                      <param name="templateLoadHandler" value="onTemplateLoaded" />

                                            <param name="@videoPlayer" value="1634355600001" />
                                          </object>

                    <script type="text/javascript">brightcove.createExperiences();</script>

                    <!-- End of Brightcove Player --> 


      <script>


        // namespace for everything global
        var BCL = {};
        // var to keep track of what's playing
        BCL.playingCount = 0;
        BCL.currentVideoID = null;
        BCL.restartPosition = null;
        BCL.loading = false;
        BCL.autoplay = true;
        BCL.content;
        BCL.language = "EN";

        // initial setup 
        function onTemplateLoaded(id) {            
          //BCL.player = brightcove.api.getExperience(id);
          BCL.player = brightcove.api.getExperience(id);                    

          BCL.experienceModule = BCL.player.getModule(brightcove.api.modules.APIModules.EXPERIENCE);

          BCL.experienceModule.addEventListener(brightcove.api.events.ExperienceEvent.TEMPLATE_READY, onTemplateReady);            

        }

        function onTemplateReady(event){               
          /*** legendas ***/
          // get a reference to the captions module
          BCL.captionsModule = BCL.player.getModule(brightcove.api.modules.APIModules.CAPTIONS);
          // add success/error listeners for captions load
          BCL.captionsModule.addEventListener(brightcove.api.events.CaptionsEvent.DFXP_LOAD_SUCCESS, BCL.onDFXPLoadSuccess);
          BCL.captionsModule.addEventListener(brightcove.api.events.CaptionsEvent.DFXP_LOAD_ERROR, BCL.onDFXPLoadError);  
          /***************/  


          BCL.experienceModule.removeEventListener(brightcove.api.events.ExperienceEvent.TEMPLATE_READY, onTemplateReady);

          // get a reference to the video player module
          BCL.videoPlayerModule = BCL.player.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);

          BCL.loading = false;          
          // save the original video id
          BCL.videoPlayerModule.getCurrentVideo(getcurrent);
          // add listener for media complete
    // BCL.videoPlayerModule.addEventListener(brightcove.api.events.MediaEvent.COMPLETE, onMediaComplete);
    // 
    //       BCL.content = BCL.player.getModule(brightcove.api.modules.APIModules.CONTENT);
    // 
    //       //Grava log ao inicar um video
    //       BCL.videoPlayerModule.addEventListener(brightcove.api.events.MediaEvent.BEGIN, onMediaEventFired);         

          // get reference to cuepoint module
          // BCL.cuePointsModule = BCL.player.getModule(brightcove.api.modules.APIModules.CUE_POINTS);          
          // //BCL.cuePointsModule.getCuePoints(BCL.originalVideoID, function(){alert('cueee')});
          // // add listener for cue points
          // BCL.cuePointsModule.addEventListener(brightcove.api.events.CuePointEvent.CUE, onCue);            
          // 
          // BCL.adModule = BCL.player.getModule(brightcove.api.modules.APIModules.ADVERTISING);

          //BCL.myChromelessPlayer = (BCL.experienceModule.getElementsByType("ChromelessVideoPlayer"))[0];

          if(BCL.autoplay)
              BCL.videoPlayerModule.pause(false);

          BCL.showSubTitles(BCL.language);
        }


                // captions load success handler
        BCL.onDFXPLoadSuccess = function(event) {            
                console.log("DFXP Load Success");
                console.log(event);
                // need to set the language based on selected language
                BCL.captionsModule.setLanguage(BCL.language);
        }
        // captions load error handler
        BCL.onDFXPLoadError = function(event) {
                console.log("DFXP Load Error");
                console.log(event);
        }

        // set up captions
      BCL.showSubTitles = function(language) {          
  console.log("In BCL.showSubTitles "+ language);
  // only do this if a subtitles language has been selected
  if (language != "") {
    // set a flag to remember that subtitles are on
    BCL.subTitlesOn = true;
    // keep track of the language
    BCL.language = language;
    // get the filename stub for the captions from the video custom field and construct the path
    BCL.videoPlayerModule.getCurrentVideo( function(videoDTO) {	                    
      var videoID = videoDTO.id;			
                        //var captionsPath = "../player/legenda.php?pid="+videoID+"&lng="+BCL.language;
                        var captionsPath = "./legenda.xml";
      // load the captions file
      BCL.captionsModule.loadDFXP(captionsPath,videoID);                        
    });
  }
  else {
    // if no language was selected, set flag to know that captions are off
    BCL.subTitlesOn = false;
  }
      }

      // BCL.onMediaChange = function(event) {	
      // oad captions if subtitles are on
      // BCL.subTitlesOn) {
      // L.showSubTitles(BCL.language);
      // 
      // }







        function getcurrent(video){                 
            BCL.originalVideoID = video.id;
            BCL.currentVideoID = video.id;            
        }


        // function mediaEventHandler(e){            
        //     return false;    
        // }
        // 
        // // handler for cue points
        // function onCue (event) {               
        //         // display a message
        //         //document.getElementById("message").innerHTML = "Bumper 1 starting ...";
        //         // save the restart position             
        //         //if(BCL.currentVideoID == BCL.originalVideoID && BCL.restartPosition == null && event.cuePoint.metadata != null){
        //         if(event.cuePoint.metadata != null){
        //           // pause the video
        //           //BCL.myChromelessPlayer.showControls(false);
        //           BCL.videoPlayerModule.pause();          
        //           BCL.restartPosition = event.cuePoint.time;		            
        //           BCL.nowPlaying ++;		                  
        //           BCL.currentVideoID = event.cuePoint.metadata
        //           BCL.videoPlayerModule.loadVideoByID(event.cuePoint.metadata);		
        //           //BCL.adModule.showSponsorMessage(true);
        //           BCL.videoPlayerModule.addEventListener(brightcove.api.events.MediaEvent.SEEK_NOTIFY, mediaEventHandler);
        //           //BCL.videoPlayerModule.setEnabled(false);                                      
        //         }                       
        // }
        // 
        // function onMediaComplete (event) {            
        //     if(BCL.currentVideoID != BCL.originalVideoID){
        //         // restart the main video
        //         BCL.videoPlayerModule.loadVideoByID(BCL.originalVideoID);
        // 
        //         seek(BCL.restartPosition);
        //         BCL.currentVideoID = BCL.originalVideoID;
        //         // seek to the restart position
        //         BCL.videoPlayerModule.removeEventListener(brightcove.api.events.MediaEvent.SEEK_NOTIFY, mediaEventHandler);                		
        //     }
        // }
        // 
        // function seek (time) {                
        //   /*
        //   it's not possible to seek unless the video is playing
        //   so check to see if it's playing and if it's not then
        //   save the time and tell the video to play
        //         */
        //   BCL.videoPlayerModule.play();     
        //   alert(time);
        //   BCL.videoPlayerModule.seek(Math.round(time)+2);   
        //     //BCL.videoPlayerModule.setEnabled(true);
        //     //BCL.adModule.showSponsorMessage(false);
        //   BCL.restartPosition = null;
        // 
        //  /*
        //   if (BCL.videoPlayerModule.getIsPlaying()) 
        //   {
        //     BCL.videoPlayerModule.seek(Math.round(time)+2);   
        //     //BCL.videoPlayerModule.setEnabled(true);
        //     //BCL.adModule.showSponsorMessage(false);
        //     BCL.restartPosition = null;
        //   }
        //   else
        //   {
        //     // add a progress listener to see when the video starts playing
        //     BCL.videoPlayerModule.addEventListener(BCMediaEvent.PROGRESS, onProgress);
        //     BCL.videoPlayerModule.play();
        //   }
        //   */
        // }
        // 
        // // handler for progress
        // function onProgress (event) { 
        //   BCL.videoPlayerModule.removeEventListener(BCMediaEvent.PROGRESS, onProgress);
        //   seek(BCL.restartPosition);
        // }
        // 
        // 
        // function playVideo(videoId){           
        //     if(videoId != null){                
        //         BCL.originalVideoID = videoId;
        //         BCL.currentVideoID = videoId;
        //         BCL.videoPlayerModule.loadVideoByID(videoId);
        //         BCL.adModule.showSponsorMessage(true);
        //     }
        //     BCL.videoPlayerModule.pause(false);    
        // }
        // function pauseVideo(){
        //     if(BCL.videoPlayerModule)
        //       BCL.videoPlayerModule.pause(true);
        // }
        // 
        // function onMediaEventFired (){   
        // 
        //     $.ajax({
        //         url: "../_misc/routines/routines.php",
        //         dataType: 'text',
        //         data: {
        //             action: "setCount",
        //             bid: BCL.currentVideoID
        //         }
        //       });
        // }
      </script>

    </body>
</html>