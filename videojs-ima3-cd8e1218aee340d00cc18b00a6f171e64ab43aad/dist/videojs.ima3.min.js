/*! videojs-ima3 - v2.1.1 - 2015-12-01
 * Copyright (c) 2015 Brightcove  */
!function(a,b,c,d){"use strict";var e=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a},f=function(a,b,c){var d,e,f=Object.prototype.toString.call(b),g=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c);else if(a.on)a.on(b,c);else{if(!a.attachEvent)throw new Error("object has no mechanism for adding event listeners");a.attachEvent("on"+b,c)}};switch(f){case"[object String]":g(a,b,c);break;case"[object Array]":for(d=0,e=b.length;e>d;d++)g(a,b[d],c);break;case"[object Object]":for(d in b)b.hasOwnProperty(d)&&g(a,d,b[d]);break;default:throw new Error("Unrecognized events parameter type: "+f)}return a},g=function(b){return a.setTimeout(b,1)},h=function(b){return a.clearTimeout(b)},i=function(a){a.ads.cancelPlayTimeout||(a.ads.cancelPlayTimeout=g(function(){a.ads.cancelPlayTimeout=null,a.paused()||a.pause(),a.one("contentplayback",function(){a.paused()&&a.play()})}))},j=function(a){var b,c,d=a.el().querySelector(".vjs-tech"),e=a.remoteTextTracks?a.remoteTextTracks():[],f=[],g={ended:a.ended(),src:a.currentSrc(),currentTime:a.currentTime(),type:a.currentType()};for(d&&(g.nativePoster=d.poster,g.style=d.getAttribute("style")),c=e.length;c--;)b=e[c],f.push({track:b,mode:b.mode}),b.mode="disabled";return g.suppressedTracks=f,g},k=function(a,b){for(var c=a.className.split(/\s+/),d=c.length,e=[];d--;)c[d]!==b&&e.push(c[d]);a.className=e.join(" ")},l=function(b,e){var f,g,h=b.el().querySelector(".vjs-tech"),i=20,j=e.suppressedTracks,k=function(){for(var a=j.length;a--;)f=j[a],f.track.mode=f.mode},l=function(){var c=!1,d=function(){c=!0};b.currentTime(e.currentTime),e.ended?(b.ads.resumeEndedTimeout=a.setTimeout(function(){c||b.play(),b.off("ended",d),b.ads.resumeEndedTimeout=null},250),b.on("ended",d),b.on("dispose",function(){a.clearTimeout(b.ads.resumeEndedTimeout)})):b.play()},m=function(){return h.readyState>1?l():h.seekable===d?l():h.seekable.length>0?l():void(i--?a.setTimeout(m,50):!function(){try{l()}catch(a){c.log.warn("Failed to resume the content after an advertisement",a)}}())};e.nativePoster&&(h.poster=e.nativePoster),"style"in e&&h.setAttribute("style",e.style||""),g=b.src()?b.src()!==e.src:b.currentSrc()!==e.src,g?(b.one("contentloadedmetadata",k),b.src({src:e.src,type:e.type}),b.load(),b.one("contentcanplay",m)):b.ended()&&e.ended||(k(),b.play())},m=function(a){var b=a.el().querySelector(".vjs-tech");b&&b.removeAttribute("poster")},n={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:!1},o=function(b){var d,o=this,p=e({},n,b||{});!function(){var a,b=c.getComponent("Html5").Events,d=function(){return!0},e=function(a,b){b.isImmediatePropagationStopped=d,b.cancelBubble=!0,b.isPropagationStopped=d,o.trigger({type:a+b.type,state:o.ads.state,originalEvent:b})},f=function(a){if("ad-playback"===o.ads.state)e("ad",a);else if("content-playback"===o.ads.state&&"ended"===a.type)e("content",a);else if("content-resuming"===o.ads.state){if(o.ads.snapshot){if(o.currentSrc()!==o.ads.snapshot.src){if("loadstart"===a.type)return;return e("content",a)}if(o.ads.snapshot.ended)return"pause"===a.type||"ended"===a.type?void o.addClass("vjs-has-started"):e("content",a)}"playing"!==a.type&&e("content",a)}};for(b.push("firstplay"),b.push("loadedalldata"),a=b.length;a--;)o.on(b[a],f);return f}(),o.on(["addurationchange","adcanplay"],function(){var a=o.ads.snapshot;o.currentSrc()!==a.src&&o.play()}),o.ads={state:"content-set",startLinearAdMode:function(){"ad-playback"!==o.ads.state&&o.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===o.ads.state&&o.trigger("adend")},skipLinearAdMode:function(){"ad-playback"!==o.ads.state&&o.trigger("adskip")}},d=function(b){var d={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?",i(o),m(o)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?",i(o)},adskip:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){o.el().className+=" vjs-ad-loading",o.ads.adTimeoutTimeout=a.setTimeout(function(){o.trigger("adtimeout")},p.prerollTimeout),o.trigger("readyforpreroll")},leave:function(){a.clearTimeout(o.ads.adTimeoutTimeout),k(o.el(),"vjs-ad-loading")},events:{play:function(){i(o)},adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){o.el().className+=" vjs-ad-loading",o.ads.adTimeoutTimeout=a.setTimeout(function(){o.trigger("adtimeout")},p.timeout)},leave:function(){a.clearTimeout(o.ads.adTimeoutTimeout),k(o.el(),"vjs-ad-loading")},events:{play:function(){i(o)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ad-playback":{enter:function(){this.snapshot=j(o),o.el().className+=" vjs-ad-playing",m(o),o.ads.cancelPlayTimeout&&(h(o.ads.cancelPlayTimeout),o.ads.cancelPlayTimeout=null)},leave:function(){k(o.el(),"vjs-ad-playing"),l(o,this.snapshot),"adend"!==o.ads.triggerevent&&o.trigger("adend")},events:{adend:function(){this.state="content-resuming"},adserror:function(){this.state="content-resuming"}}},"content-resuming":{enter:function(){this.snapshot.ended&&(a.clearTimeout(o.ads._fireEndedTimeout),o.ads._fireEndedTimeout=a.setTimeout(function(){o.trigger("ended")},1e3))},leave:function(){a.clearTimeout(o.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},contentresumed:function(){this.state="content-playback"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=j(o),o.el().className+=" vjs-ad-loading",o.ads.adTimeoutTimeout=a.setTimeout(function(){o.trigger("adtimeout")},p.postrollTimeout)},leave:function(){a.clearTimeout(o.ads.adTimeoutTimeout),k(o.el(),"vjs-ad-loading")},events:{adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-resuming",g(function(){o.trigger("ended")})},adtimeout:function(){this.state="content-resuming",g(function(){o.trigger("ended")})},adserror:function(){this.state="content-resuming",g(function(){o.trigger("ended")})}}},"content-playback":{enter:function(){o.ads.cancelPlayTimeout&&(h(o.ads.cancelPlayTimeout),o.ads.cancelPlayTimeout=null),o.trigger({type:"contentplayback",triggerevent:o.ads.triggerevent})},events:{adsready:function(){o.trigger("readyforpreroll")},adstart:function(){this.state="ad-playback"},contentupdate:function(){o.paused()?this.state="content-set":this.state="ads-ready?"},contentended:function(){this.state="postroll?"}}}};!function(a){var e=function(){};((d[a].events||{})[b.type]||e).apply(o.ads),a!==o.ads.state&&(o.ads.triggerevent=b.type,(d[a].leave||e).apply(o.ads),(d[o.ads.state].enter||e).apply(o.ads),p.debug&&c.log("ads",o.ads.triggerevent+" triggered: "+a+" -> "+o.ads.state))}(o.ads.state)},f(o,c.getComponent("Html5").Events.concat(["adtimeout","contentupdate","contentplaying","contentended","contentresumed","adsready","adserror","adscanceled","adstart","adend","adskip"]),d),o.ads.contentSrc=o.currentSrc(),function(){var a=function(){var a;"ad-playback"!==o.ads.state&&(a=o.currentSrc(),a!==o.ads.contentSrc&&(o.trigger({type:"contentupdate",oldValue:o.ads.contentSrc,newValue:a}),o.ads.contentSrc=a))};o.on("loadstart",a),g(a)}(),o.paused()||d({type:"play"})};c.plugin("ads",o)}(window,document,videojs),function(a,b,c,d){var e=c.ima3={},f=e.defaults={sdkurl:(/^(file|data):/.test(location.protocol)?"http:":"")+"//s0.2mdn.net/instream/html5/ima3.js",adTechOrder:["flash","html5"],serverUrl:("file:"===location.protocol?"http:":"")+"//pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dlinear",adSwf:("file:"===location.protocol?"http:":"")+"//players.brightcove.net/videojs-ima3/videojs.ima3.swf",loadingSpinner:!1,timeout:5e3,prerollTimeout:1e3,requestMode:"onload"},g=function(e){var g,i,j,k,l=h({},f,e||{}),m=this,n=m.el().querySelector(".vjs-tech"),o=l.adTechOrder,p=!1;"adControlBar"in l||(l.adControlBar=h({},m.options_.children.controlBar,{name:"adControlBar"})),m.ads(l),j=function(a){return function(){var b,d,e=this,f=e.activeCues[e.activeCues.length-1],g=function(f){if(e.activeCues.length&&f.value&&"TXXX"===f.value.key)try{b=JSON.parse(f.value.data),"adCue"===b.name&&(d=a.ima3.adMacroReplacement(b.parameters.serverUrl||a.ima3.settings.serverUrl),c.log("ondemand ad request at ",Math.floor(f.startTime)),a.ima3.adrequest(d+"&breaklength="+b.parameters.duration))}catch(g){c.log("ERROR: Parsing JSON. Please confirm that JSON is valid.")}};f&&Math.floor(f.startTime)-k===0?c.log("do not request ondemand ad for the same cuechange event"):g(f),f&&(k=Math.floor(f.startTime))}},"oncue"===l.requestMode&&m.on("loadstart",function(){var a,b,c=m.textTracks();if(c.length>0)for(b=0;b<c.length;b++)a=c[b],"metadata"===a.kind&&(a.mode="hidden",a.addEventListener("cuechange",j(m)));else c.addEventListener("addtrack",function(b){a=b.track,"metadata"===a.kind&&(a.mode="hidden",a.addEventListener("cuechange",j(m)))})}),m.on("ima3-ready",function(){var a;for(m.ima3.isReady_=!0,a=0;a<m.ima3.readyQueue_.length;a++)m.ima3.readyQueue_[a].call(this);m.ima3.readyQueue_=[]}),m.ima3={readyQueue_:[],isReady_:!1,player:m,tech:n,settings:l,ready:function(a){return a&&(m.ima3.isReady_?a.call(this):(m.ima3.readyQueue_===d&&(m.ima3.readyQueue_=[]),m.ima3.readyQueue_.push(a))),m.ima3},makeAdRequestFunction:function(a){return function(b){var d=b||this.settings.serverUrl;return d?(c.log("Clearing any previous VAST ad data and triggering ondemand adrequest."),void a.call(m,d)):void c.log("On demand adRequest attempted without an adTagUrl!")}},adMacroReplacement:function(c){var d={"{player.id}":m.id(),"{mediainfo.id}":"","{mediainfo.name}":"","{mediainfo.description}":"","{mediainfo.tags}":"","{mediainfo.reference_id}":"","{mediainfo.duration}":"","{player.duration}":m.duration(),"{timestamp}":(new Date).getTime(),"{document.referrer}":b.referrer,"{window.location.href}":a.location.href,"{random}":Math.floor(1e12*Math.random())};m.mediainfo&&(d["{mediainfo.id}"]=m.mediainfo.id,d["{mediainfo.name}"]=m.mediainfo.name,d["{mediainfo.description}"]=m.mediainfo.description,d["{mediainfo.tags}"]=m.mediainfo.tags,d["{mediainfo.reference_id}"]=m.mediainfo.reference_id,d["{mediainfo.duration}"]=m.mediainfo.duration),m.bcAnalytics&&(d["{player.url}"]=a.location.protocol+"//"+m.bcAnalytics.settings.player);for(var e in d)c=c.split(e).join(encodeURIComponent(d[e]));return c},version:"2.1.1"},m.on("adplay",function(){m.currentSrc()===m.ads.snapshot.src&&setTimeout(function(){m.pause()},0)});for(g=0;g<o.length;g++)if(i=o[g].charAt(0).toUpperCase()+o[g].substring(1).toLowerCase(),c.getComponent(i).isSupported()){c.ima3[i].call(m,l),m.addClass("vjs-ima3-"+i.toLowerCase()),l.loadingSpinner&&m.addClass("ima3-loading-spinner"),p=!0;break}return p?void 0:void c.log("No supported ad tech available. If you have removed one of the default ad techs, you may want to consider adding it back in.")},h=c.ima3.extend=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a};c.ima3.AdPlayer=c.extend(c.getComponent("Component"),{constructor:function(){var a=[this].concat(Array.prototype.slice.call(arguments));c.getComponent("Component").apply(this,a)},buffered:function(){return[]},language:function(){},languages:function(){},localize:function(){},muted:function(a){return a!==d?0===this.volume(a?0:1):0===this.volume()},remainingTime:function(){return this.duration()-this.currentTime()},exitFullscreen:function(){return this.options_.contentPlayer.exitFullscreen()},reportUserActivity:function(){},requestFullscreen:function(){return this.options_.contentPlayer.requestFullscreen()},textTracks:function(){},remoteTextTracks:function(){},addTextTrack:function(){},addRemoteTextTrack:function(){},removeRemoteTextTrack:function(){},scrubbing:function(){}}),c.plugin("ima3",g)}(window,document,videojs),function(a,b,c,d){var e=c.ima3.extend,f=c.ima3.Html5=function(d){var f,j,k,l,m,n,o,p,q,r,s=this,t=s.el().querySelector(".vjs-tech"),u=b.createElement("div"),v=function(){s.ima3&&s.ima3.adsManager&&s.ima3.adsManager.skip&&s.ima3.adsManager.skip(),o()};u.className="vjs-ima3-ad-container",t.parentNode.insertBefore(u,t.nextSibling),r=function(a){s.ads.startLinearAdMode(),o(),m(d,a),s.addClass("ima3-ad-loading")},c.ima3.Html5.adrequest=function(){return c.log.warn("videojs.ima3.Html5.adrequest is deprecated. Use player.ima3.adrequest instead."),r.apply(this,arguments)},s.ima3.adrequest=s.ima3.makeAdRequestFunction(r),s.on("ima3-content-pause-requested",function(a){s.ads.startLinearAdMode(),s.addClass("ima3-ad-loading")}),s.on("ima3-content-resume-requested",function(a){s.ads.endLinearAdMode(),s.removeClass("ima3-ad-loading")}),s.on("fullscreenchange",function(a){var b,c=" "+s.el().className+" ",d=c.indexOf(" vjs-fullscreen ")>-1,e=3,f=function(a,c){return function(){b===p.ViewMode.FULLSCREEN?s.ima3.adsManager.resize(s.el().offsetWidth,s.el().offsetHeight,b):s.ima3.adsManager.resize(s.width(),s.height(),b),(s.width()!==a||s.height()!==c)&&e--&&setTimeout(f(s.width(),s.height()),1e3)}};s.ima3&&s.ima3.adsManager&&(b=d?p.ViewMode.FULLSCREEN:p.ViewMode.NORMAL,b===p.ViewMode.FULLSCREEN?s.ima3.adsManager.resize(s.el().offsetWidth,s.el().offsetHeight,b):s.ima3.adsManager.resize(s.width(),s.height(),b),setTimeout(f(s.width(),s.height()),1e3))}),s.on("ima3-started",function(){s.removeClass("ima3-ad-loading"),c.log("ima3-started")}),s.on("ima3-ad-error",function(a){a.originalEvent&&c.log("ima3-ad-error",a.originalEvent.getError().toString(),a),s.removeClass("ima3-ad-loading"),s.trigger("adserror")}),s.on("ima3-loaded",function(a){var b=a.originalEvent.getAd();s.ima3.currentAd=b,s.removeClass("ima3-ad-loading"),b&&!b.isLinear()&&s.addClass("vjs-ima3-overlay")}),s.on("ima3-complete",function(a){var b=a.originalEvent.getAd();c.log("ima3-complete"),delete s.ima3.currentAd,b&&(b.isLinear()?s.addClass("ima3-ad-loading"):s.removeClass("vjs-ima3-overlay"))}),s.on("resize",function(){s.ima3.adsManager&&s.ima3.adsManager.resize(s.width(),s.height(),p.ViewMode.NORMAL)}),s.on("readyforpreroll",function(){n()}),s.on("adserror",function(){o()}),s.on("ima3-ads-manager-loaded",function(a){var b,c;s.ima3.managerCleanup&&o(),c={},c.currentTime=s.currentTime(),c.duration=s.duration(),s.on("timeupdate",function(){c.currentTime=s.currentTime()}),b=a.originalEvent.getAdsManager(c),s.ima3.adsManager=b,s.ima3.managerCleanup=i(b,q,s),"ad-playback"===s.ads.state?n():s.trigger("adsready")}),l=function(a,b){return s.ima3.adsRequest=e(new p.AdsRequest,{adTagUrl:s.ima3.adMacroReplacement(b||s.ima3.settings.serverUrl),linearAdSlotWidth:s.width(),linearAdSlotHeight:s.height(),nonLinearAdSlotWidth:s.width(),nonLinearAdSlotHeight:s.height()}),s.ima3.adsRequest.adTagUrl?void s.ima3.adsLoader.requestAds(s.ima3.adsRequest):void s.trigger("adscanceled")},m=function(a,b){"onplay"===a.requestMode?s.one("play",function(){l(a,b)}):l(a,b)},n=function(){try{s.ima3.adsManager.init(s.width(),s.height(),p.ViewMode.NORMAL),s.ima3.adsManager.start()}catch(a){s.trigger("adserror")}},o=function(){s.ima3.adsManager&&(s.ima3.adsManager.destroy(),s.ima3.adsManager=null),s.ima3.managerCleanup&&(s.ima3.managerCleanup(),s.ima3.managerCleanup=null)},k=function(){var b,e,g,k=d.ima3SdkSettings,l=c.getComponent("ControlBar"),n=t;if(p=a.google.ima,q=h(p),d.ima3SdkSettings)for(e in d.ima3SdkSettings)g="set"+e.charAt(0).toUpperCase()+e.slice(1),p.ImaSdkSettings[g](k[e]);j=c.ima3.Html5.adPlayer(u,{contentPlayer:s}),f=new l(j,d.adControlBar),f.addClass("vjs-ad-control-bar"),s.addClass("vjs-ad-controls"),s.addChild(f),s.ima3.adControlBar=f,s.ima3.adPlayer=j,s.on("adstart",function(a){s.pause()}),s.ima3.adDisplayContainer=new p.AdDisplayContainer(u,n,d.clickTrackingElement),s.one("touchstart",function(){s.ima3.adDisplayContainer.initialize()}),s.ima3.adsLoader=new p.AdsLoader(s.ima3.adDisplayContainer),b=s.ima3.adsLoader.getSettings(),b.setPlayerVersion(s.ima3.version),b.setPlayerType("brightcove/player-html5"),s.ima3.loaderCleanup=i(s.ima3.adsLoader,q,s),s.currentSrc()&&"ondemand"!==d.requestMode&&"oncue"!==d.requestMode&&m(d),s.on("contentupdate",function(){"ondemand"!==d.requestMode&&"oncue"!==d.requestMode&&m(d)}),s.on("contentended",function(){"postroll?"===s.ads.state&&(s.one("adtimeout",v),s.ima3.adsLoader.contentComplete())}),s.on(["contentupdate","dispose"],function(){s.off("adtimeout",v)}),s.ima3.el=u},a.google&&a.google.ima?(k(),s.trigger("ima3-ready")):g(d.sdkurl,function(a){k(),a?s.trigger({type:"adserror",info:a}):s.trigger("ima3-ready")})},g=function(a,c){var d=b.createElement("script"),e=b.querySelector("head");d.async=!0,d.src=a,d.onload=d.onreadystatechange=function(a,b){(b||!d.readyState||/loaded|complete/.test(d.readyState))&&(d.onload=d.onreadystatechange=null,d.parentNode.removeChild(d),d=null,c(b))},e.insertBefore(d,e.firstChild)},h=f.eventTypes=function(a){for(var b,c,d={},e=function(a){return"ima3-"+a.toLowerCase().replace(/_/g,"-")},f=["AdErrorEvent","AdEvent","AdsManagerLoadedEvent"],g=f.length;g--;)if(a[f[g]]&&a[f[g]].Type){b=a[f[g]].Type;for(c in b)b.hasOwnProperty(c)&&(d[b[c]]=[b[c],e(c)])}return d},i=function(a,b,c){var d,e={},f=function(b,d){var f=function(b){c.trigger({type:d,emitter:a,originalEvent:b})};e[b]=f,a.addEventListener(b,f,!1)};for(d in b)f(b[d][0],b[d][1]);return function(){var b;for(b in e)a.removeEventListener(b,e[b])}};c.ima3.Html5.adPlayer=function(b,e){var f=e.contentPlayer,g=new c.ima3.AdPlayer(e),h=!0,i=1,j=function(){g.paused()||g.trigger("timeupdate"),a.setTimeout(j,250)};return g.currentTime=function(){var a,b=g.duration();return b?(a=f.ima3.adsManager.getRemainingTime(),0>=a?0:a>b?0:a>0?b-a:void 0):0},g.duration=function(){var a,b=f.ima3.currentAd;return b?(a=b.getDuration(),a>0?a:0):0},g.pause=function(){h=!0,f.ima3.adsManager.pause()},g.paused=function(){return h},g.play=function(){h=!1,f.ima3.adsManager.resume(),g.trigger("play")},g.isFullscreen=function(){return f.isFullscreen()},g.requestFullscreen=function(){return f.requestFullscreen()},g.volume=function(a){return a!==d&&(f.ima3.adsManager.setVolume(a),i=a,g.trigger("volumechange")),i},f.on("ima3-started",function(){f.removeClass("vjs-ima3-paused"),g.trigger("play"),h=!1}),f.on("ima3-resumed",function(){f.removeClass("vjs-ima3-paused"),g.trigger("play"),h=!1}),f.on("ima3-paused",function(){f.addClass("vjs-ima3-paused"),g.trigger("pause"),h=!0}),j(),g}}(window,document,window.videojs),function(a,b,c){var d=function(a,b){for(var c=a,d=b.split("."),e=0;e<d.length;e++)c[d[e]]||(c[d[e]]={}),c=c[d[e]];return c};b.ima3.Flash=function(c){var e,f,g,h,i,j=this,k=document.createElement("div"),l='<param name="flashvars" value="playerId='+j.el().id+"&debug="+j.ima3.settings.debug+'"><param name="wmode" value="transparent"><param name="AllowScriptAccess" value="always">',m=j.el().id+"-ima3-flash",n=b.getComponent("ControlBar"),o=function(b){return b&&!/^https?:|file:/.test(b)?a.location.protocol+b:b},p=function(){g.vjs_postrolltimeout()};i=function(a){j.ima3.ready(function(){g.vjs_trigger({type:"adrequest",adTag:j.ima3.adMacroReplacement(o(a)),currentTime:j.currentTime(),options:{}})})},b.ima3.Flash.adrequest=function(){return b.log.warn("videojs.ima3.Flash.adrequest is deprecated. Use player.ima3.adrequest instead."),i.apply(this,arguments)},j.ima3.adrequest=j.ima3.makeAdRequestFunction(i),c.serverUrl=o(c.serverUrl),k.className="vjs-ima3-ad-background",k.innerHTML='<!--[if !IE]>--><object width="100%" height="100%" type="application/x-shockwave-flash" data="'+c.adSwf+'">'+l+"</object><!--<![endif]-->",g=k.querySelector("object"),g||(k.innerHTML='<object width="100%" height="100%" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">  <param name="movie" value="'+c.adSwf+'">'+l+"</object>",g=k.querySelector("object")),g.id=m,g.name=m,g.className="vjs-ima3-ad-container vjs-ima3-flash-ad-container",d(a,"google.ima.ImaSdkSettings").setAutoPlayAdBreaks=function(a){g.vjs_autoplayadbreaks(a)},d(a,"google.ima.AdsManager").getRemainingTime=function(){return g.vjs_getRemainingTime()},d(a,"google.ima.AdsManager").destroy=function(){return g.vjs_destroyAdsManager()},j.el().insertBefore(k,j.el().querySelector(".vjs-big-play-button")),f=b.ima3.Flash.adPlayer(g,{contentPlayer:j}),e=new n(f,c.adControlBar),e.addClass("vjs-ad-control-bar"),j.addClass("vjs-ad-controls"),j.addChild(e),j.on("adstart",function(a){j.pause()}),h=a.setInterval(function(){var b=function(a){g.vjs_trigger({type:a.type,options:{serverUrl:j.ima3.adMacroReplacement(j.ima3.settings.serverUrl)}})};g.vjs_trigger&&(j.trigger("ima3-ready"),a.clearInterval(h),j.on("readyforpreroll",b),j.on("contentended",function(a){"postroll?"===j.ads.state&&(j.one("adtimeout",p),a.type="ended",b(a))}),j.on(["contentupdate","dispose"],function(){j.off("adtimeout",p)}),j.on("timeupdate",function(a){g.vjs_trigger({type:a.type,currentTime:j.currentTime()})}),j.on("contentupdate",function(a){var d=j.currentSrc();j.ima3.currentSrc!==d&&(j.ima3.currentSrc=d,"onplay"===c.requestMode?j.one("play",function(a){b({type:"contentupdate"})}):"onload"===c.requestMode&&b(a))}),j.ready(function(){var a=j.currentSrc();a&&j.ima3.currentSrc!==a&&(j.ima3.currentSrc=a,"onplay"===c.requestMode?j.one("play",function(){b({type:"contentupdate"})}):"onload"===c.requestMode&&b({type:"contentupdate"}))}),j.on("debug",function(a){g.vjs_trigger({type:a.type,enable:a.enable})}))},50),j.ima3.adControlBar=e,j.ima3.adPlayer=f,j.ima3.el=g,j.ima3.adsManager=google.ima.AdsManager},b.ima3.Flash.adPlayer=function(d,e){var f=e.contentPlayer,g=new b.ima3.AdPlayer(e),h=0,i=-1,j=function(a,b){return function(){var c="vjs_"+a;return d[c]?d[c].apply(d,Array.prototype.slice.call(arguments)):b}},k=j("duration",-1),l=j("currentTime"),m=(j("pause"),j("play"),j("volume",1));return function(){var b,c=!1,d=250,e=function(){c&&(i(),a.setTimeout(e,d))},i=function(){var a=+new Date;h+=a-b,b=a,g.trigger("timeupdate")};g.on("play",function(){f.removeClass("vjs-ima3-paused"),c=!0,b=+new Date,a.setTimeout(e,d)}),g.on("pause",function(){f.addClass("vjs-ima3-paused"),c=!1}),g.on("ima3-started",function(){h=0,b=+new Date})}(),g.currentTime=function(){return Math.min(h/1e3,g.duration())},g.on("durationchange",function(){var a=l(),b=0>a?0:a;i=k(),h=1e3*b}),g.on("ima3-started",function(){f.removeClass("vjs-ima3-paused"),i=k()}),g.on("adserror",function(){f.trigger("adserror")}),g.on("adscanceled",function(){f.trigger("adscanceled")}),g.duration=function(){return 0>i&&(i=k()),i},g.isFullscreen=function(){return f.isFullscreen()},g.requestFullscreen=function(){return f.requestFullscreen()},g.volume=function(a){var b=m();return a===c||a===b?b:(m(a),void g.trigger("volumechange"))},g.pause=j("pause"),g.paused=j("paused"),g.play=j("play"),g}}(window,window.videojs);