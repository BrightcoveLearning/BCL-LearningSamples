

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: lib/fontResizer.js | Gallery</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">
    <link type="text/css" rel="stylesheet" href="styles/videojs.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 50px; height: 50px">
        
            <img src="https://brightcovelearning.github.io/Brightcove-API-References/brightcove-player/doc-header-image/bc-logo.png" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Gallery</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="ClientApi.html">ClientApi</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ClientApi_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ClientApi.html#getAllVideos">getAllVideos</a></li><li><a href="ClientApi.html#getCurrentState">getCurrentState</a></li><li><a href="ClientApi.html#getCurrentVideo">getCurrentVideo</a></li><li><a href="ClientApi.html#off">off</a></li><li><a href="ClientApi.html#on">on</a></li><li><a href="ClientApi.html#once">once</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="ClientApi.html#event:interactionCardPanelClose">interactionCardPanelClose</a></li><li><a href="ClientApi.html#event:interactionCardPanelOpen">interactionCardPanelOpen</a></li><li><a href="ClientApi.html#event:interactionClick">interactionClick</a></li><li><a href="ClientApi.html#event:interactionEnd">interactionEnd</a></li><li><a href="ClientApi.html#event:interactionStart">interactionStart</a></li><li><a href="ClientApi.html#event:playerChanged">playerChanged</a></li><li><a href="ClientApi.html#event:playerLoaded">playerLoaded</a></li><li><a href="ClientApi.html#event:stateChanged">stateChanged</a></li><li><a href="ClientApi.html#event:videoChanged">videoChanged</a></li><li><a href="ClientApi.html#event:videoLoaded">videoLoaded</a></li><li><a href="ClientApi.html#event:videoPaused">videoPaused</a></li><li><a href="ClientApi.html#event:videoStarted">videoStarted</a></li></ul><div class="member-type">Typedef</div><ul class="inner"><li><a href="ClientApi.html#~InteractivityEvent">InteractivityEvent</a></li><li><a href="ClientApi.html#~Player">Player</a></li><li><a href="ClientApi.html#~Video">Video</a></li></ul></div></li><li><a href="VideoFetcher.html">VideoFetcher</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="VideoFetcher_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="VideoFetcher.html#getVideo">getVideo</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="VideoFetcher.html#emitError">emitError</a></li><li><a href="VideoFetcher.html#emitVideos">emitVideos</a></li><li><a href="VideoFetcher.html#fetch">fetch</a></li><li><a href="VideoFetcher.html#fetchConfigurationVideos">fetchConfigurationVideos</a></li><li><a href="VideoFetcher.html#fetchLiveVodVideos">fetchLiveVodVideos</a></li><li><a href="VideoFetcher.html#fetchManualVideos">fetchManualVideos</a></li><li><a href="VideoFetcher.html#fetchPlaylistVideos">fetchPlaylistVideos</a></li><li><a href="VideoFetcher.html#isExperienceConfigValid">isExperienceConfigValid</a></li><li><a href="VideoFetcher.html#noVideos">noVideos</a></li></ul><div class="member-type">Events</div><ul class="inner"><li><a href="VideoFetcher.html#event:videoError">videoError</a></li><li><a href="VideoFetcher.html#event:videos">videos</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#connect">connect</a></li><li><a href="global.html#deepEqual">deepEqual</a></li><li><a href="global.html#ensureExplicitProtocol">ensureExplicitProtocol</a></li><li><a href="global.html#ensureProtocol">ensureProtocol</a></li><li><a href="global.html#escapeForHtml">escapeForHtml</a></li><li><a href="global.html#escapeForRegex">escapeForRegex</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#getAllVideosFromState">getAllVideosFromState</a></li><li><a href="global.html#getCssUrl">getCssUrl</a></li><li><a href="global.html#getFontResizeFunction">getFontResizeFunction</a></li><li><a href="global.html#getFontSize">getFontSize</a></li><li><a href="global.html#getHelperTextKey">getHelperTextKey</a></li><li><a href="global.html#getIn">getIn</a></li><li><a href="global.html#getLocation">getLocation</a></li><li><a href="global.html#getMinMaxFontSizes">getMinMaxFontSizes</a></li><li><a href="global.html#getPlaylist">getPlaylist</a></li><li><a href="global.html#getPoster">getPoster</a></li><li><a href="global.html#getReferrer">getReferrer</a></li><li><a href="global.html#getSourceUrl">getSourceUrl</a></li><li><a href="global.html#getSwipeOffset">getSwipeOffset</a></li><li><a href="global.html#getSwipeVideoChange">getSwipeVideoChange</a></li><li><a href="global.html#getThumbnail">getThumbnail</a></li><li><a href="global.html#getUrlForVideo">getUrlForVideo</a></li><li><a href="global.html#getVideosArrayFromState">getVideosArrayFromState</a></li><li><a href="global.html#getVideosFromState">getVideosFromState</a></li><li><a href="global.html#getVideosFromStateForConfig">getVideosFromStateForConfig</a></li><li><a href="global.html#getVideosOrEmpty">getVideosOrEmpty</a></li><li><a href="global.html#hasProtocol">hasProtocol</a></li><li><a href="global.html#isDataProp">isDataProp</a></li><li><a href="global.html#isNonNullObject">isNonNullObject</a></li><li><a href="global.html#isSecure">isSecure</a></li><li><a href="global.html#joinStyleClassNames">joinStyleClassNames</a></li><li><a href="global.html#maxNonNull">maxNonNull</a></li><li><a href="global.html#merge">merge</a></li><li><a href="global.html#mergeIn">mergeIn</a></li><li><a href="global.html#minNonNull">minNonNull</a></li><li><a href="global.html#noVideos">noVideos</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#parseQueryString">parseQueryString</a></li><li><a href="global.html#remove">remove</a></li><li><a href="global.html#sameMembers">sameMembers</a></li><li><a href="global.html#selectHtmlProps">selectHtmlProps</a></li><li><a href="global.html#selectProps">selectProps</a></li><li><a href="global.html#selectSvgProps">selectSvgProps</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#setFontSizes">setFontSizes</a></li><li><a href="global.html#setIn">setIn</a></li><li><a href="global.html#shallowEqual">shallowEqual</a></li><li><a href="global.html#shallowEqualArray">shallowEqualArray</a></li><li><a href="global.html#stringify">stringify</a></li><li><a href="global.html#stringifyQuery">stringifyQuery</a></li><li><a href="global.html#toQueryString">toQueryString</a></li><li><a href="global.html#updateTextSize">updateTextSize</a></li><li class="hidden"><a href="global.html#URLParts">URLParts</a></li><li><a href="global.html#videoConfigHasChanged">videoConfigHasChanged</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Functions for resizing fonts within html (used for rich text)
 */

/**
 * Gets the max number in the list ignoring null values
 */
function maxNonNull (...args) {
  return Math.max.apply(null, args.filter(arg => arg != null));
}

/**
 * Gets the min number in the list ignoring null values
 */
function minNonNull (...args) {
  return Math.min.apply(null, args.filter(arg => arg != null));
}

/**
 * Gets the font size of a given element (is an approximation which is appropriate for our use-case)
 *
 * @param {Element} element HTML element
 * @param {number} baseFontSize Base font size to use if no font size is specified on the element
 * @returns {number} Element's font size
 */
function getFontSize (element, baseFontSize) {
  const fontSize = parseFloat(element.style.fontSize || baseFontSize);

  //Adjust font sizes for header elements (use multipliers from text.less)
  switch (element.tagName) {
    case 'H1': return fontSize * 2;
    case 'H2': return fontSize * 1.5;
    case 'H3': return fontSize * 1.2;
    default: return fontSize;
  }
}

/**
 * Gets the min and max font sizes recursively inside the given HTML element
 *
 * @param {Element} parent Parent HTML element
 * @param {number} baseFontSize Base font size to use
 * @returns {number[]} Tuple containing the min font size and max font size
 */
function getMinMaxFontSizes (parent, baseFontSize) {
  let maxActiveFontSize = null;
  let minActiveFontSize = null;

  //Get the font size of the element. This font size applies to all child text nodes and and elements inside of the
  //parent, so we only need to calculate it once. It is included in the min/max calculation if this element directly
  //contains text nodes, and is passed as the baseFontSize for calculating the min/max font sizes of child elements.
  const fontSize = getFontSize(parent, baseFontSize);

  for (const node of parent.childNodes) {
    if (node.nodeType === Node.TEXT_NODE) {
      //This element contains text directly, so include the current font size in the min / max calculation
      minActiveFontSize = minNonNull(minActiveFontSize, fontSize);
      maxActiveFontSize = maxNonNull(maxActiveFontSize, fontSize);
    } else if (node.nodeType === Node.ELEMENT_NODE) {
      //Recursively get the min / max font sizes of child elements
      const [min, max] = getMinMaxFontSizes(node, fontSize);

      maxActiveFontSize = maxNonNull(maxActiveFontSize, max);
      minActiveFontSize = minNonNull(minActiveFontSize, min);
    }
  }
  return [minActiveFontSize, maxActiveFontSize];
}

/**
 * Sets the font sizes of elements inside the given HTML element based on a function
 * @param {Element} parent Parent HTML element [will be mutated]
 * @param {number} baseFontSize Base font size to use
 * @param {function(number): number} resizeFunc Function which takes in the current font size and returns the new font
 *                                              size
 */
function setFontSizes (parent, baseFontSize, resizeFunc) {
  for (const node of parent.children) {
    const fontSize = getFontSize(node, baseFontSize);
    const newFontSize = resizeFunc(fontSize);

    node.style.fontSize = `${newFontSize}px`;
    setFontSizes(node, fontSize, resizeFunc);
  }
}

/**
 * Gets a function for performing resizing on the text of an element
 * @param {Element} parent Parent HTML Element
 * @param {number} baseFontSize Base font size to use
 * @param {number} minFontSize Minimum font size
 * @param {number} maxFontSize Maximum font size
 * @returns {function(number): number|null} Font resizing function or null
 */
function getFontResizeFunction (parent, baseFontSize, minFontSize, maxFontSize) {
  //If we don't have a minimum or a maximum size, or if our min and max are the same, we can't do any scaling.  Simply
  //ensure the min/max size is adhered to
  if (minFontSize === maxFontSize) {
    return () => minFontSize;
  } else if (!minFontSize) {
    return fontSize => minNonNull(fontSize, maxFontSize);
  } else if (!maxFontSize) {
    return fontSize => maxNonNull(fontSize, minFontSize);
  }

  //Get the min and max size from our element
  const [minActiveFontSize, maxActiveFontSize] = getMinMaxFontSizes(parent, baseFontSize);

  if (maxActiveFontSize !== minActiveFontSize) {
    //Scale the fonts to be within the sizes
    const fontScale = (maxFontSize - minFontSize) / (maxActiveFontSize - minActiveFontSize);
    return fontSize => (fontSize - minActiveFontSize) * fontScale + minFontSize;
  } else if (maxActiveFontSize > maxFontSize) {
    return () => maxFontSize;
  } else if (minActiveFontSize &lt; minFontSize) {
    return () => minFontSize;
  }
}
/**
 * Scales the font sizes of elements inside the given HTML element using a minimum and maximum font size.  Mutates the
 * element passed in.
 *
 * @param {Element} parent Parent HTML element [will be mutated]
 * @param {number} baseFontSize Base font size to use
 * @param {number} minFontSize Minimum font size
 * @param {number} maxFontSize Maximum font size
 */
function updateTextSize (parent, baseFontSize, minFontSize, maxFontSize) {
  if (!parent || !baseFontSize || !(minFontSize || maxFontSize)) {
    //Can't perform any resizing if the parent element or base font size are null, and we need either a min or max
    //size (or both)
    return;
  }

  const resizeFunc = getFontResizeFunction(parent, baseFontSize, minFontSize, maxFontSize);
  if (resizeFunc) {
    setFontSizes(parent, baseFontSize, resizeFunc);
  }
}

module.exports = {
  updateTextSize,
};
</code></pre>
        </article>
    </section>




</div>

    <footer>
        <img class="logo" src="https://brightcovelearning.github.io/Brightcove-API-References/brightcove-player/doc-header-image/bc-logo.png" style="width: 50px; height: 46px">
        <div class="footer-text"><span class='copyright'>©2018 <a href='https://brightcove.com' target='_blank'>Brightcove, Inc</a>.</div>
    </footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
