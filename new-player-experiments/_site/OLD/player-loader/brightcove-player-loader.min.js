/*! @name @brightcove/player-loader @version 1.2.1 @license Apache-2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["global/window","global/document"],t):e.brightcovePlayerLoader=t(e.window,e.document)}(this,function(e,t){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=["catalogSearch","catalogSequence"],o=["applicationId","catalogSearch","catalogSequence","playlistId","playlistVideoId","videoId"],i=function(e){return Object.keys(e).filter(function(e){return-1!==o.indexOf(e)}).reduce(function(t,n){var o=function(e,t){if(e&&void 0!==e[t]){if("string"!=typeof e[t]&&-1!==r.indexOf(t))try{return encodeURIComponent(JSON.stringify(e[t]))}catch(e){return}return encodeURIComponent(String(e[t]).trim())||void 0}}(e,n);return void 0!==o&&(t+=t?"&":"?",t+=encodeURIComponent(n)+"="+o),t},"")},a=function(e){var t=e.accountId,r=e.base,o=void 0===r?"https://players.brightcove.net":r,a=e.playerId,c=void 0===a?"default":a,d=e.embedId,u=void 0===d?"default":d,l=e.iframe,s=void 0!==l&&l,f=e.minified,p=void 0===f||f,y=e.queryParams,m=void 0===y?null:y,b="";s?b+="html":(p&&(b+="min."),b+="js"),"/"===o.charAt(o.length-1)&&(o=o.substring(0,o.length-1));var v="";return s&&m&&"object"===(void 0===m?"undefined":n(m))&&(v=i(m)),o+"/"+(t=encodeURIComponent(t))+"/"+(c=encodeURIComponent(c))+"_"+(u=encodeURIComponent(u))+"/index."+b+v};
/*! @name @brightcove/player-url @version 1.1.1 @license Apache-2.0 */a.VERSION="1.1.1";var c={embedId:"default",embedType:"in-page",playerId:"default",Promise:e.Promise,refNodeInsert:"append"},d="in-page",u="iframe",l="append",s="prepend",f="before",p="after",y="replace",m=["catalogSearch","catalogSequence"],b="https://players.brightcove.net/",v=function(e){var t=e.accountId,n=e.playerId,r=e.embedId,o=e.embedType===u;return a({accountId:t,playerId:n,embedId:r,iframe:o,base:b,queryParams:e})},E=function(){return b},h=function(e){b=e},I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g=function(e){return Boolean(e&&1===e.nodeType)},w=function(e,n){return e?function(e,n){if(!e.pip)return n;var r=t.createElement("div");return r.classList.add("vjs-pip-container"),r.appendChild(n),r}(e,function(e,n){if(!e.responsive)return n;n.style.position="absolute",n.style.top="0px",n.style.right="0px",n.style.bottom="0px",n.style.left="0px",n.style.width="100%",n.style.height="100%";var r=I({aspectRatio:"16:9",maxWidth:"100%"},e.responsive),o=r.aspectRatio.split(":").map(Number),i=t.createElement("div");i.style.paddingTop=o[1]/o[0]*100+"%",i.appendChild(n);var a=t.createElement("div");return a.style.position="relative",a.style.display="block",a.style.maxWidth=r.maxWidth,a.appendChild(i),a}(e,n)):n},N=function(e){return function(e,n){var r=e.refNodeInsert,o=e.refNode;if("string"==typeof o&&(o=t.querySelector(o)),!g(o)||!o.parentNode)throw new Error("missing/invalid refNode");var i=w(e.embedOptions,n);if(r===f?o.parentNode.insertBefore(i,o):r===p?o.parentNode.insertBefore(i,o.nextElementSibling||null):r===y?o.parentNode.replaceChild(i,o):r===s?o.insertBefore(i,o.firstChild||null):o.appendChild(i),e.embedOptions&&e.embedOptions.playlist){var a=t.createElement("div");a.classList.add("vjs-playlist"),n.parentNode.insertBefore(a,n.nextElementSibling||null)}return e.refNode=null,n}(e,function(e,t){if("function"!=typeof e.onEmbedCreated)return t;var n=e.onEmbedCreated(t);return g(n)?n:t}(e,e.embedType===u?function(e){var n=t.createElement("iframe");return n.setAttribute("allow","autoplay;encrypted-media;fullscreen"),n.setAttribute("allowfullscreen","allowfullscreen"),n.src=v(e),n}(e):function(e){var n={applicationId:"data-application-id",catalogSearch:"data-catalog-search",catalogSequence:"data-catalog-sequence",playlistId:"data-playlist-id",playlistVideoId:"data-playlist-video-id",videoId:"data-video-id"},r=t.createElement("video-js");return Object.keys(n).filter(function(t){return e[t]}).forEach(function(t){var o=void 0;if("string"!=typeof e[t]&&-1!==m.indexOf(t))try{o=JSON.stringify(e[t])}catch(e){return}else o=String(e[t]).trim();r.setAttribute(n[t],o)}),r.setAttribute("controls","controls"),r.classList.add("video-js"),r}(e)))},O=new e.Map,R=function(e){var t=e.accountId,n=e.playerId,r=e.embedId;return(t||"*")+"_"+n+"_"+r},S=function(){O.clear()},_=function(e){O.forEach(e)},j=function(e){return O.has(R(e))},P=function(e){O.set(R(e),e.accountId?v(e):"")},C=/^([A-Za-z0-9]+)_([A-Za-z0-9]+)$/,T=function(){return e.bc?Object.keys(e.bc).filter(function(e){return C.test(e)}):[]},x=function(e){e&&Object.keys(e.players).forEach(function(t){var n=e.players[t];n&&n.dispose()})},A=function(){_(function(e,n){e&&Array.prototype.slice.call(t.querySelectorAll('script[src="'+e+'"]')).forEach(function(e){return e.parentNode.removeChild(e)})}),S(),x(e.videojs),T().forEach(function(t){return x(e.bc[t].videojs)}),Object.keys(e).filter(function(e){return/^videojs/i.test(e)||/^(bc)$/.test(e)}).forEach(function(t){delete e[t]})};(function(){T().forEach(function(e){var t=e.match(C),n={playerId:t[1],embedId:t[2]};j(n)||P(n)})})();var q=function(e){return"function"==typeof e},B=function(e){var t=e.accountId,n=e.embedOptions,r=e.embedType,o=e.options,i=e.refNode,a=e.refNodeInsert;if(!t)throw new Error("accountId is required");if(!i)throw new Error("refNode is required");if(!("string"==typeof i||1===i.nodeType&&i.parentNode))throw new Error("if refNode is not a string, it must be a DOM node with a parent");if(!function(e){return e===d||e===u}(r))throw new Error("embedType is missing or invalid");if(r===u&&o)throw new Error("cannot use options with an iframe embed");if(n&&n.responsive&&n.responsive.aspectRatio&&!/^\d+\:\d+$/.test(n.responsive.aspectRatio))throw new Error('embedOptions.responsive.aspectRatio must be in the "n:n" format (value: "'+n.responsive.aspectRatio+'")');if(!function(e){return e===l||e===s||e===f||e===p||e===y}(a))throw new Error("refNodeInsert is missing or invalid")},D=function(t,n){var r=t.playerId,o=t.embedId,i=e.bc[r+"_"+o]||e.bc;return i?{type:d,ref:i(n,t.options)}:new Error("missing bc function for "+r)},F=function(e,n,r){B(e);var o=e.refNode,i=N(e);if(e.embedType!==u)if(j(e))n(D(e,i));else{var a=t.createElement("script");a.onload=function(){P(e),n(D(e,i))},a.onerror=function(){r(new Error("player script could not be downloaded"))},a.async=!0,a.charset="utf-8",a.src=v(e),o.appendChild(a)}else n({type:u,ref:i})},U=function(e){var t=I({},c,e),n=t.Promise,r=t.onSuccess,o=t.onFailure;return!q(n)||q(r)||q(o)?F(t,q(r)?r:function(){},q(o)?o:function(e){throw e}):new n(function(e,n){return F(t,e,n)})},k=function(e,t){Object.defineProperty(U,e,{configurable:!1,enumerable:!0,value:t,writable:!1})};return k("getBaseUrl",function(){return E()}),k("setBaseUrl",function(e){h(e)}),k("getUrl",function(e){return v(e)}),k("reset",function(){return A()}),[["EMBED_TYPE_IN_PAGE",d],["EMBED_TYPE_IFRAME",u],["REF_NODE_INSERT_APPEND",l],["REF_NODE_INSERT_PREPEND",s],["REF_NODE_INSERT_BEFORE",f],["REF_NODE_INSERT_AFTER",p],["REF_NODE_INSERT_REPLACE",y],["VERSION","1.2.1"]].forEach(function(e){k(e[0],e[1])}),U});
