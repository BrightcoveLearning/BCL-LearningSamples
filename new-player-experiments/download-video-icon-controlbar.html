<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Untitled Document</title>
  <style type="text/css">
      #downloadButton {
  	width: 34px;
  	height: 33px;
  	margin-top: 6px;
       }
  </style>
</head>

<body>

  <video id="myPlayerID" style="width: 640px; height: 360px;"
  	data-video-id="4093643993001"
  	data-account="1752604059001"
  	data-player="VJuPrI3cg"
  	data-embed="default"
  	class="video-js"
  	controls></video>
  <script src="//players.brightcove.net/1752604059001/VJuPrI3cg_default/index.min.js"></script>

  <script type="text/javascript">
      videojs("myPlayerID").ready(function() {
            // Create variables and new div, anchor and image for download icon
            var myPlayer = this,
              videoName,
              totalRenditions,
              mp4Ara=[],
              highestQuality,
              spacer,
      	    newElement = document.createElement('div'),
      	    newLink = document.createElement('a'),
      	    newImage = document.createElement('img');

            myPlayer.on('loadstart',function(){
              //Reinitialize array of MP4 renditions in case used with playlist
              //This prevents the array having a cumulative list for all videos in playlist
              mp4Ara=[];
              // Get video name and the MP4 renditions
              videoName = myPlayer.mediainfo['name'];
              rendtionsAra = myPlayer.mediainfo.sources;
              totalRenditions = rendtionsAra.length;
              for (var i = 0; i < totalRenditions; i++) {
                if (rendtionsAra[i].container === "MP4" && rendtionsAra[i].hasOwnProperty('src')) {
                  mp4Ara.push(rendtionsAra[i]);
                };
              };
              // Sort the renditions from highest to lowest
              mp4Ara.sort( function (a,b){
                return b.size - a.size;
              });
              // Set the highest rendition
              highestQuality= mp4Ara[0].src;

              // Assign id and classes to div for icon
              newElement.id = 'downloadButton';
              newElement.className = 'downloadStyle vjs-control';

              // Assign properties to elements and assign to parents
              newImage.setAttribute('src','http://solutions.brightcove.com/bcls/brightcove-player/download-video/file-download.png');
              newLink.setAttribute('href',highestQuality);
              newLink.setAttribute('download', videoName);
              newLink.appendChild(newImage);
              newElement.appendChild(newLink);

              // Get the spacer element
              spacer = myPlayer.controlBar.customControlSpacer.el();
              // Set the content of the spacer to be right justified
              spacer.setAttribute("style", "justify-content: flex-end;");
              // Place the new element in the spacer
              spacer.appendChild(newElement);
            })
          });
  </script>

</body>

</html>
