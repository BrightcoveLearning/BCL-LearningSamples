<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Untitled Document</title>
  <style media="screen">
    .video-js {
      width: 480px;
      height: 270px;
    }
  </style>
  <link href="//players.brightcove.net/videojs-ima3/2/videojs.ima3.min.css" rel="stylesheet">
</head>

<body>

  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent iaculis est et libero ultricies condimentum. Suspendisse ut ante sed leo consequat cursus eget a ex. Etiam aliquet augue sed elit aliquet iaculis. Nunc iaculis ultrices congue. Pellentesque at enim sapien. Donec nec semper sem. Aenean dui quam, euismod vel commodo nec, cursus tempor risus. Donec ligula mi, imperdiet quis lorem id, blandit semper dolor. Duis accumsan tempor malesuada.</p> <p> Duis ullamcorper varius vulputate. Mauris et purus neque. Duis at erat vulputate purus mattis blandit ac id erat. Nullam tempor metus in lorem aliquam gravida. Nullam id eros condimentum dui maximus posuere non et neque. Fusce dapibus neque finibus nunc accumsan lobortis.</p>
  <p>Curabitur scelerisque mi a ante euismod congue. Suspendisse rhoncus, odio non faucibus cursus, metus diam vestibulum velit, eu commodo nunc orci et purus. Sed eget ultrices sem. Nullam egestas ipsum augue, eu condimentum ipsum bibendum ac. Phasellus varius orci eget est aliquam posuere. Nam ornare at felis ut fermentum. Suspendisse auctor ultricies augue vitae dapibus. Nam efficitur urna velit, quis interdum augue vestibulum et. Pellentesque aliquam, massa et condimentum viverra, lacus est mattis ipsum, nec facilisis eros tortor quis justo.</p>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent iaculis est et libero ultricies condimentum. Suspendisse ut ante sed leo consequat cursus eget a ex. Etiam aliquet augue sed elit aliquet iaculis. Nunc iaculis ultrices congue. Pellentesque at enim sapien. Donec nec semper sem. Aenean dui quam, euismod vel commodo nec, cursus tempor risus. Donec ligula mi, imperdiet quis lorem id, blandit semper dolor. Duis accumsan tempor malesuada.</p>
  <p>Duis ullamcorper varius vulputate. Mauris et purus neque. Duis at erat vulputate purus mattis blandit ac id erat. Nullam tempor metus in lorem aliquam gravida. Nullam id eros condimentum dui maximus posuere non et neque. Fusce dapibus neque finibus nunc accumsan lobortis.</p>
  <p>Curabitur scelerisque mi a ante euismod congue. Suspendisse rhoncus, odio non faucibus cursus, metus diam vestibulum velit, eu commodo nunc orci et purus. Sed eget ultrices sem. Nullam egestas ipsum augue, eu condimentum ipsum bibendum ac. Phasellus varius orci eget est aliquam posuere. Nam ornare at felis ut fermentum. Suspendisse auctor ultricies augue vitae dapibus. Nam efficitur urna velit, quis interdum augue vestibulum et. Pellentesque aliquam, massa et condimentum viverra, lacus est mattis ipsum, nec facilisis eros tortor quis justo.</p> <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent iaculis est et libero ultricies condimentum. Suspendisse ut ante sed leo consequat cursus eget a ex. Etiam aliquet augue sed elit aliquet iaculis. Nunc iaculis ultrices congue. Pellentesque at enim sapien. Donec nec semper sem. Aenean dui quam, euismod vel commodo nec, cursus tempor risus. Donec ligula mi, imperdiet quis lorem id, blandit semper dolor. Duis accumsan tempor malesuada.</p>

  <video id="myPlayerID"
    data-video-id="5234654230001"
    data-account="1752604059001"
    data-player="SJG8mzTBZ"
    data-embed="default"
    data-application-id class="video-js" controls></video>


  <p>Duis ullamcorper varius vulputate. Mauris et purus neque. Duis at erat vulputate purus mattis blandit ac id erat. Nullam tempor metus in lorem aliquam gravida. Nullam id eros condimentum dui maximus posuere non et neque. Fusce dapibus neque finibus nunc accumsan lobortis.</p>
  <p>Curabitur scelerisque mi a ante euismod congue. Suspendisse rhoncus, odio non faucibus cursus, metus diam vestibulum velit, eu commodo nunc orci et purus. Sed eget ultrices sem. Nullam egestas ipsum augue, eu condimentum ipsum bibendum ac. Phasellus varius orci eget est aliquam posuere. Nam ornare at felis ut fermentum. Suspendisse auctor ultricies augue vitae dapibus. Nam efficitur urna velit, quis interdum augue vestibulum et. Pellentesque aliquam, massa et condimentum viverra, lacus est mattis ipsum, nec facilisis eros tortor quis justo.</p>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent iaculis est et libero ultricies condimentum. Suspendisse ut ante sed leo consequat cursus eget a ex. Etiam aliquet augue sed elit aliquet iaculis. Nunc iaculis ultrices congue. Pellentesque at enim sapien. Donec nec semper sem. Aenean dui quam, euismod vel commodo nec, cursus tempor risus. Donec ligula mi, imperdiet quis lorem id, blandit semper dolor. Duis accumsan tempor malesuada.</p>
  <p>Duis ullamcorper varius vulputate. Mauris et purus neque. Duis at erat vulputate purus mattis blandit ac id erat. Nullam tempor metus in lorem aliquam gravida. Nullam id eros condimentum dui maximus posuere non et neque. Fusce dapibus neque finibus nunc accumsan lobortis.</p>
  <p>Curabitur scelerisque mi a ante euismod congue. Suspendisse rhoncus, odio non faucibus cursus, metus diam vestibulum velit, eu commodo nunc orci et purus. Sed eget ultrices sem. Nullam egestas ipsum augue, eu condimentum ipsum bibendum ac. Phasellus varius orci eget est aliquam posuere. Nam ornare at felis ut fermentum. Suspendisse auctor ultricies augue vitae dapibus. Nam efficitur urna velit, quis interdum augue vestibulum et. Pellentesque aliquam, massa et condimentum viverra, lacus est mattis ipsum, nec facilisis eros tortor quis justo.</p>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent iaculis est et libero ultricies condimentum. Suspendisse ut ante sed leo consequat cursus eget a ex. Etiam aliquet augue sed elit aliquet iaculis. Nunc iaculis ultrices congue. Pellentesque at enim sapien. Donec nec semper sem. Aenean dui quam, euismod vel commodo nec, cursus tempor risus. Donec ligula mi, imperdiet quis lorem id, blandit semper dolor. Duis accumsan tempor malesuada.</p>
  <p>Duis ullamcorper varius vulputate. Mauris et purus neque. Duis at erat vulputate purus mattis blandit ac id erat. Nullam tempor metus in lorem aliquam gravida. Nullam id eros condimentum dui maximus posuere non et neque. Fusce dapibus neque finibus nunc accumsan lobortis.</p>
  <p>Curabitur scelerisque mi a ante euismod congue. Suspendisse rhoncus, odio non faucibus cursus, metus diam vestibulum velit, eu commodo nunc orci et purus. Sed eget ultrices sem. Nullam egestas ipsum augue, eu condimentum ipsum bibendum ac. Phasellus varius orci eget est aliquam posuere. Nam ornare at felis ut fermentum. Suspendisse auctor ultricies augue vitae dapibus. Nam efficitur urna velit, quis interdum augue vestibulum et. Pellentesque aliquam, massa et condimentum viverra, lacus est mattis ipsum, nec facilisis eros tortor quis justo.</p>

  <script src="//players.brightcove.net/1752604059001/SJG8mzTBZ_default/index.min.js"></script>
  <script src="//players.brightcove.net/videojs-ima3/2/videojs.ima3.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

  <script type="text/javascript">
    videojs('myPlayerID').ready(function() {
      var myPlayer = this,
        isAdPlaying = false;

      // +++ Configure IMA3 plugin +++
      myPlayer.ima3({
        // only use HTML5 mode
        adTechOrder: ["html5"],
        // you can increase or decrease the max amount of time to wait for an ad
        timeout: 5000,
        // this is where your ad tag goes
        serverUrl: "//solutions.brightcove.com/bcls/brightcove-player/vmap/simple-vmap.xml"
      });

      // +++ Execute every time page is scrolled +++
      window.onscroll = checkIfVideoInView;

      // +++ Called on scroll, check if in view and the play/pause +++
      function checkIfVideoInView() {
        // check if we are in ad or content playback
        //  and get reference to the relevant player
        var currentPlayer = !isAdPlaying ? myPlayer : myPlayer.ima3.adPlayer;
        if (isScrolledIntoView(myPlayer.el())) {
          // the player is fully in the viewport
          currentPlayer.play();
          // ensure the conent player is paused
          if (isAdPlaying) {
            myPlayer.pause();
          }
        } else {
          // the player is not in the viewport
          currentPlayer.pause();
        }
      };

      // +++ Checks if player is in view +++
      function isScrolledIntoView(elem) {
        // Get the position of the viewport
        var docViewTop = $(window).scrollTop();
        var docViewBottom = docViewTop + $(window).height();

        // get the position of the player element
        var elemTop = $(elem).offset().top;
        var elemBottom = elemTop + $(elem).height();

        // Determine if the player element is in fully in the viewport
        return (
          elemBottom >= docViewTop &&
          elemTop <= docViewBottom &&
          elemBottom <= docViewBottom &&
          elemTop >= docViewTop
        );
      };

      // +++ Set Boolean value for if ad is playing +++
      myPlayer.on(
        [
          'ads-ad-started',
          'ads-ad-ended',
          'ima3-complete',
          'ads-ad-skipped',
          'adserror',
          'ads-allpods-completed'],
        function(evtObject) {
          if (evtObject.type == 'ads-ad-started') {
            isAdPlaying = true;
          } else {
            isAdPlaying = false;
          }
      });

    });
  </script>

</body>

</html>
